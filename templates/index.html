<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ app_title }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
  </head>
  <body>
    <div class="bg-sheen"></div>
    <div class="app">
      <header class="hero">
        <div>
          <p class="eyebrow">DashScope 语音工作室</p>
          <h1>{{ app_title }}</h1>
          <p class="subtitle">设计或复刻音色，然后进行实时语音合成。</p>
        </div>
        <div class="api-box">
          <label for="apiKey">API 密钥</label>
          <input id="apiKey" type="password" placeholder="粘贴 DASHSCOPE_API_KEY 或留空" />
          <p class="hint">部署时建议使用环境变量。</p>
        </div>
      </header>

      <div class="grid">
        <section class="card" id="designCard">
          <div class="card-header">
            <h2>1. 音色设计</h2>
            <span class="pill">设计 + 调用</span>
          </div>

          <div class="field">
            <label for="designPrompt">声音描述</label>
            <textarea id="designPrompt" rows="4" placeholder="描述音色风格"></textarea>
          </div>

          <div class="field">
            <label for="designPreview">预览文本</label>
            <input id="designPreview" type="text" placeholder="用于创建音色的预览内容" />
          </div>

          <div class="field-grid">
            <div class="field">
              <label for="designName">音色别名</label>
              <input id="designName" type="text" placeholder="announcer" />
            </div>
            <div class="field">
              <label for="designLang">语言</label>
              <input id="designLang" type="text" placeholder="zh" value="zh" />
            </div>
          </div>

          <div class="field-grid">
            <div class="field">
              <label for="designModel">目标模型</label>
              <input id="designModel" type="text" value="qwen3-tts-vd-realtime-2025-12-16" />
            </div>
            <div class="field">
              <label for="designSampleRate">采样率</label>
              <input id="designSampleRate" type="number" value="24000" />
            </div>
          </div>

          <div class="field">
            <label for="designResponseFormat">响应格式</label>
            <select id="designResponseFormat">
              <option value="wav" selected>WAV</option>
              <option value="mp3">MP3</option>
            </select>
          </div>

          <button class="primary" id="designCreateBtn">生成音色</button>

          <div class="output">
            <div class="status" id="designStatus">空闲</div>
            <div class="result-row">
              <span>音色名称</span>
              <strong id="designVoiceName">-</strong>
            </div>
            <audio id="designPreviewPlayer" controls></audio>
          </div>

          <div class="divider"></div>

          <div class="field">
            <label for="designTtsText">合成文本</label>
            <input id="designTtsText" type="text" placeholder="输入要合成的文本" />
          </div>

          <button class="secondary" id="designTtsBtn">用设计音色合成</button>
          <audio id="designTtsPlayer" controls></audio>
        </section>

        <section class="card" id="enrollCard">
          <div class="card-header">
            <h2>2. 音色复刻</h2>
            <span class="pill">复刻 + 调用</span>
          </div>

          <div class="field">
            <label for="enrollAudio">上传音频（≥5秒）</label>
            <input id="enrollAudio" type="file" accept="audio/*" />
          </div>

          <div class="field-grid">
            <div class="field">
              <label for="enrollName">音色别名</label>
              <input id="enrollName" type="text" placeholder="guanyu" />
            </div>
            <div class="field">
              <label for="enrollMime">音频 MIME</label>
              <input id="enrollMime" type="text" value="audio/mpeg" />
            </div>
          </div>

          <div class="field">
            <label for="enrollModel">目标模型</label>
            <input id="enrollModel" type="text" value="qwen3-tts-vc-realtime-2026-01-15" />
          </div>

          <button class="primary" id="enrollCreateBtn">上传并创建音色</button>

          <div class="output">
            <div class="status" id="enrollStatus">空闲</div>
            <div class="result-row">
              <span>音色名称</span>
              <strong id="enrollVoiceName">-</strong>
            </div>
          </div>

          <div class="divider"></div>

          <div class="field">
            <label for="enrollTtsText">合成文本</label>
            <input id="enrollTtsText" type="text" placeholder="输入要合成的文本" />
          </div>

          <button class="secondary" id="enrollTtsBtn">用复刻音色合成</button>
          <audio id="enrollTtsPlayer" controls></audio>
        </section>
      </div>

      <footer class="footer">
        <p>可在页面调整参数，或在 app.py 中修改默认值。</p>
      </footer>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
  </body>
</html>
